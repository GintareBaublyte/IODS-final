install.packages("pacman")
library(pacman)
p_load(tidyverse, descr, haven)
lrn14 <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep="\t", header=TRUE)
structure(lrn14)
?str
?structure
str(lrn14)
dim(lrn14)
library(MASS)
data("Boston")
str("Boston")
str(data)
library(MASS)
data("Boston")
str(data)
str(Boston)
dim(Boston)
dim(Boston)
str(Boston)
summary(Boston)
?str
str(Boston)
pairs(Boston)
```{r}
pairs(Boston)
var.cor <- function(x, y, digits=2, prefix="", cex.cor, ...)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y))
txt <- format(c(r, 0.123456789), digits=digits)[1]
txt <- paste(prefix, txt, sep="")
if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
pairs(Boston)
?pairs
install.packages("ggplot2")
install.packages("ggplot2")
library(ggplot2)
library(ggplot2)
plotmatrix(with(Boston))
ggpairs(Boston)
library(ggplot2)
p <- ggpairs(Boston, mapping = aes(alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
install.packages("ggplot2")
install.packages("ggplot2")
library(ggplot2)
p <- ggpairs(Boston, mapping = aes(alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
library(ggplot2)
p <- ggpairs(Boston, mapping = aes(alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
library(ggplot2)
p <- ggplot(Boston, mapping = aes(alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
p
pairs(Boston, main = "Pairs matrix", pch = 21,
bg = c("red", "green3", "blue", "yellow"), upper.panel = NULL)
pairs(Boston, main = "Pairs matrix", upper.panel = NULL)
summary(Boston)
install.packages("tidyverse")
library(tidyverse)
library("tidyverse")
cor_matrix<-cor(Boston) %>% round(digits = 2)
library(dplyr)
cor_matrix<-cor(Boston) %>% round(digits = 2)
cor_matrix
corrplot.mixed(cor_matrix, method="circle", type = "upper", cl.pos = "b", tl.pos = "d", tl.cex = 0.6)
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
library("tidyverse")
remove.packages(c("tidyverse", "ggplot2"))
install.packages('tidyverse', dependencies = TRUE)
install.packages("tidyverse", dependencies = TRUE)
install.packages('ggplot2', dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
library(tidyverse)
library("tidyverse")
library('tidyverse')
install.packages("tidyverse")
install.packages("tidyverse")
library('tidyverse')
ggpairs(human_)
library(plyr)
setwd("C:/Users/Severi/Documents/Open Data/IODS-project/data")
library(MASS)
library(dplyr)
library('corrplot')
library(GGally)
human_ <- read.table(file = "human2.txt", sep = ";")
str(human_)
dim(human_)
ggpairs(human_)
cor_matrix<-cor(human_) %>% round(digits = 2)
corrplot.mixed(cor_matrix)
summary(human_)
pca_human <- prcomp(human_)
summary(pca_human)
biplot(pca_human, choices = 1:2, cex = c(0.8, 1), col = c("grey40", "deeppink2"))
human_std <- scale(human_)
summary(human_std)
pca_human2 <- prcomp(human_std)
summary(pca_human2)
biplot(pca_human2, choices = 1:2, cex = c(0.8, 1), col = c("grey40", "deeppink2"))
library(Factominer)
library('Factominer')
install.packages("FactoMineR")
library('Factominer')
library(FactoMineR)
data("tea")
str(tea)
dim(tea)
str(tea)
mca <- MCA(tea, graph = FALSE)
colnames(tea)
keep_columns <- c("Tea", "How", "how", "where", "frequency", "spirituality")
library(FactoMineR)
data("tea")
dim(tea)
keep_columns <- c("Tea", "How", "how", "where", "frequency", "spirituality")
tea_time <- dplyr::select(tea, one_of(keep_columns))
summary(tea_time)
data("tea")
keep_columns <- c("Tea", "How", "how", "feminine", "frequency", "spirituality")
tea_time <- dplyr::select(tea, one_of(keep_columns))
summary(tea_time)
mca <- MCA(tea_time, graph = FALSE)
summary(mca)
plot(mca, invisible = c("ind"), habillage = "quali")
mca <- MCA(tea_time, graph = TRUE)
mca <- MCA(tea_time, graph = FALSE)
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
library(tidyr)
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
library(MASS)
library(dplyr)
library('corrplot')
library(GGally)
library(tidyr)
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
library(ggplot2)
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
summary(mca)
?theme
setwd("~/GitHub/IODS-final")
library(MASS)
library(dplyr)
library('corrplot')
library(GGally)
library(tidyr)
library(ggplot2)
hr_sales <- read.table(file = "hr_sales.txt", header = T, sep = ";")
str(hr_sales)
ggpairs(hr_sales)
pairs(hr_sales)
pairs(hr_sales, main = "Pairs matrix", upper.panel = NULL)
cor_matrix<-cor(hr_sales) %>% round(digits = 2)
summary(hr_sales)
g1 <- ggplot(hr_sales, aes(x = satisfied, y= time_spend_company))
g1 + geom_boxplot(aes()) + xlab("Satisfied with job") + ylab("Years spent at the company") + ggtitle("Years spent at the company by satisfaction with the job")
counts_years <- table(hr_sales$satisfied, hr_sales$time_spend_company)
barplot(counts_years, main="Years in company vs Satisfaction with job",
xlab="Years in company", col=c("darkblue","red"),
legend = rownames(counts_studytime), beside=TRUE)
counts_years <- table(hr_sales$satisfied, hr_sales$time_spend_company)
barplot(counts_years, main="Years in company vs Satisfaction with job",
xlab="Years in company", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
table_years <- xtabs(~satisfied+time_spend_company, data=hr_sales)
ftable(table_years)
counts_years <- table(hr_sales$satisfied, hr_sales$time_spend_company)
barplot(counts_years, main="Years in company vs Satisfaction with job",
xlab="Years in company", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
table_years <- xtabs(~satisfied+time_spend_company, data=hr_sales)
ftable(table_years)
counts_years <- table(hr_sales$satisfied, hr_sales$time_spend_company)
barplot(counts_years, main="Years in company vs Satisfaction with job",
xlab="Years in company", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
p1 <- ggplot(hr_sales, aes(x = time_spend_company, y = satisfaction_level, col = satisfied))
p2 <- p1 + geom_point()
p3 <- p2 + geom_smooth(method = "lm")
p4 <- p3 + ggtitle("Years spent in company vs Satisfaction level")
p4
table_years <- xtabs(~satisfied+time_spend_company, data=hr_sales)
ftable(table_years)
counts_years <- table(hr_sales$satisfied, hr_sales$time_spend_company)
barplot(counts_years, main="Years in company vs Satisfaction with job",
xlab="Years in company", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
p1 <- ggplot(hr_sales, aes(x = last_evaluation, y = satisfaction_level, col = satisfied))
p2 <- p1 + geom_point()
p3 <- p2 + geom_smooth(method = "lm")
p4 <- p3 + ggtitle("Years spent in company vs Satisfaction level")
p4
table_years <- xtabs(~satisfied+time_spend_company, data=hr_sales)
ftable(table_years)
counts_years <- table(hr_sales$satisfied, hr_sales$time_spend_company)
barplot(counts_years, main="Years in company vs Satisfaction with job",
xlab="Years in company", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
table_evaluation <- xtabs(~satisfied+last_evaluation, data=hr_sales)
ftable(table_evaluation)
counts_evaluation <- table(hr_sales$satisfied, hr_sales$last_evaluation)
barplot(counts_evaluation, main="Lat evaluation vs Satisfaction with job",
xlab="Last evaluation score", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
table_evaluation <- xtabs(~satisfied+last_evaluation, data=hr_sales)
ftable(table_evaluation)
counts_evaluation <- table(hr_sales$satisfied, hr_sales$last_evaluation)
barplot(counts_evaluation, main="Lat evaluation vs Satisfaction with job",
xlab="Last evaluation score", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
g1 <- ggplot(hr_sales, aes(x = satisfied, y= last_evaluation))
g1 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Last evaluation score") + ggtitle("Last evaluation score by job satisfaction")
keep_columns <- c("number_project", "average_montly_hours")
workload <- dplyr::select(hr_sales, one_of(keep_columns))
keep_columns <- c("number_project", "average_montly_hours", "salary")
workload <- dplyr::select(hr_sales, one_of(keep_columns))
p1 <- ggplot(workload, aes(x = number_projects, y = average_montly_hours, col = salary))
p2 <- p1 + geom_point()
p3 <- p2 + geom_smooth(method = "lm")
p4 <- p3 + ggtitle("Number of project vs Average monthly hours at work")
p4
p1 <- ggplot(workload, aes(x = number_project, y = average_montly_hours, col = salary))
p2 <- p1 + geom_point()
p3 <- p2 + geom_smooth(method = "lm")
p4 <- p3 + ggtitle("Number of project vs Average monthly hours at work")
p4
p1 <- ggplot(workload, aes(x = average_montly_hours, y = number_project, col = salary))
p2 <- p1 + geom_point()
p3 <- p2 + geom_smooth(method = "lm")
p4 <- p3 + ggtitle("Number of project vs Average monthly hours at work")
p4
keep_columns <- c("number_project", "average_montly_hours", "salary")
workload <- dplyr::select(hr_sales, one_of(keep_columns))
p1 <- ggplot(workload, aes(x = number_project, y = average_montly_hours, col = salary))
p2 <- p1 + geom_point()
p3 <- p2 + geom_smooth(method = "lm")
p4 <- p3 + ggtitle("Number of project vs Average monthly hours at work")
p4
p <- ggpairs(workload, mapping = aes(col = salary, alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
p
cor_matrix <- cor(workload)
cor_matrix <- cor(c(workload$number_project, workload$average_montly_hours)
corrplot.mixed(cor_matrix)
cor_matrix <- cor(c(workload$number_project, workload$average_montly_hours))
cor_matrix <- cor(x = workload$number_project, y = workload$average_montly_hours)
corrplot.mixed(cor_matrix)
cor_matrix <- cor(workload, workload$number_project, y = workload$average_montly_hours)
pairs(workload, upper.panel = NULL)
ggpairs(workload, upper.panel = NULL)
g1 <- ggplot(hr_sales, aes(x = satisfied, y= number_project))
g1 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Number of projects") + ggtitle("NUmber of projects by job satisfaction")
g1 <- ggplot(hr_sales, aes(x = satisfied, y= number_project))
g1 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Number of projects") + ggtitle("NUmber of projects by job satisfaction")
g3 <- ggplot(hr_sales, aes(x = satisfied, y= average_montly_hours))
g3 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Average monthly hours") + ggtitle("Average monthly hours by job satisfaction")
table_years <- xtabs(~satisfied+time_spend_company, data=hr_sales)
ftable(table_years)
counts_years <- table(hr_sales$satisfied, hr_sales$time_spend_company)
barplot(counts_years, main="Years in company vs Satisfaction with job",
xlab="Years in company", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
g3 <- ggplot(hr_sales, aes(x = left, y= average_montly_hours))
g3 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Average monthly hours") + ggtitle("Average monthly hours by job satisfaction")
g3 <- ggplot(hr_sales, aes(x = satisfied, y= average_montly_hours))
g3 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Average monthly hours") + ggtitle("Average monthly hours by job satisfaction")
table_accidents <- xtabs(~satisfied+Work_accident, data=hr_sales)
ftable(table_accidents)
counts_accidents <- table(hr_sales$satisfied, hr_sales$Work_accident)
barplot(counts_accidents, main="Work accidents vs Satisfaction with job",
xlab="Work accidents", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
table_accidents <- xtabs(~satisfied+Work_accident, data=hr_sales)
ftable(table_accidents)
counts_accidents <- table(hr_sales$satisfied, hr_sales$Work_accident)
barplot(counts_accidents, main="Work accidents vs Satisfaction with job",
xlab="Work accidents", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
g4 <- ggplot(hr_sales, aes(x = satisfied, y= Work_accident))
g4 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Work accidents") + ggtitle("Work accidents by job satisfaction")
g4 <- ggplot(hr_sales, aes(x = satisfied, y= left))
g4 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Last evaluation score") + ggtitle("Last evaluation score by job satisfaction")
g4 <- ggplot(hr_sales, aes(x = satisfied, y= promotion_last_5years))
g4 + geom_boxplot(aes()) + xlab("Satisfaction with job") + ylab("Received a promotion in last 5 y.") + ggtitle("Received a promotion by job satisfaction")
counts_promotion <- table(hr_sales$satisfied, hr_sales$promotion_last_5years)
barplot(counts_promotion, main="Received a promotion vs Satisfaction with job",
xlab="Received a promotion", col=c("darkblue","red"),
legend = rownames(counts_years), beside=TRUE)
table_promotion <- xtabs(~satisfied+promotion_last_5years, data=hr_sales)
ftable(table_promotion)
